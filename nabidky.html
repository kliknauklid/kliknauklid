<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>NabÃ­dky Ãºklidu | Klik na Ãºklid</title>

<style>
body { font-family: Arial, sans-serif; margin: 20px; }
h1 { text-align: center; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; }
th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
th { background-color: #4a148c; color: white; }
tr:nth-child(even) { background: #f9f9f9; }
.lock { color: #888; font-style: italic; }
</style>
</head>

<body>

<h1>NabÃ­dky Ãºklidu</h1>
<p style="text-align:center;">
Kontakty jsou skrytÃ© ğŸ”’ (budou viditelnÃ© aÅ¾ po registraci nebo zaplacenÃ­)
</p>

<table id="nabidkyTable">
  <thead>
    <tr>
      <th>MÄ›sto / lokalita</th>
      <th>Dojezd (km)</th>
      <th>Typ Ãºklidu</th>
      <th>Dostupnost</th>
      <th>Frekvence</th>
      <th>Cena</th>
      <th>DalÅ¡Ã­ poznÃ¡mka</th>
      <th>Kontakt</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRc1EKWsR4iHnhk1PSgVAQ5u_YfM481jOzs9mxzXLvIZ0bhtz0TFRAAzw_15LJhvNSpyzb6dMA6IK0r/pub?output=csv";

// jednoduchÃ½ CSV parser (Å™eÅ¡Ã­ i ÄÃ¡rky v uvozovkÃ¡ch)
function parseCSV(text) {
  const rows = [];
  let row = [];
  let cell = "";
  let insideQuotes = false;

  for (let char of text) {
    if (char === '"') {
      insideQuotes = !insideQuotes;
    } else if (char === "," && !insideQuotes) {
      row.push(cell);
      cell = "";
    } else if (char === "\n" && !insideQuotes) {
      row.push(cell);
      rows.push(row);
      row = [];
      cell = "";
    } else {
      cell += char;
    }
  }
  if (cell) row.push(cell);
  if (row.length) rows.push(row);
  return rows;
}

fetch(sheetUrl)
  .then(res => res.text())
  .then(csv => {
    const data = parseCSV(csv);
    const rows = data.slice(1); // bez hlaviÄky
    let html = "";

    rows.forEach(cols => {
      if (!cols.length) return;

      html += `
        <tr>
          <td>${cols[4] || ""}</td>
          <td>${cols[5] || ""}</td>
          <td>${cols[6] || ""}</td>
          <td>${cols[7] || ""}</td>
          <td>${cols[8] || ""}</td>
          <td>${cols[10] || ""}</td>
          <td>${cols[12] || ""}</td>
          <td class="lock">ğŸ”’ Kontakt po registraci</td>
        </tr>
      `;
    });

    document.querySelector("#nabidkyTable tbody").innerHTML = html;
  })
  .catch(err => {
    console.error(err);
    document.body.innerHTML += "<p style='color:red;'>NepodaÅ™ilo se naÄÃ­st nabÃ­dky.</p>";
  });
</script>

</body>
</html>
