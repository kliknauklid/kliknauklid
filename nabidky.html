<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Nab√≠dky √∫klidu</title>
<style>
body{font-family:Arial;background:#f4f6fb;margin:0;padding:20px}
h1{text-align:center}
table{width:100%;border-collapse:collapse;background:white}
th,td{border:1px solid #ccc;padding:8px;text-align:left}
th{background:#1f2a6d;color:white}
.lock{color:red;font-weight:bold}
.btn{padding:6px 10px;background:#1f2a6d;color:white;border:none;border-radius:5px;cursor:pointer}
</style>
</head>

<body>

<h1>Nab√≠dky √∫klidu</h1>
<p style="text-align:center">Kontakty jsou skryt√© üîí ‚Äì odemknou se po zaplacen√≠</p>

<table>
<thead>
<tr>
<th>Vlo≈æen√≠</th>
<th>Mƒõsto</th>
<th>Dojezd</th>
<th>Typ √∫klidu</th>
<th>Dostupnost</th>
<th>Cena</th>
<th>Zku≈°enost</th>
<th>Pozn√°mka</th>
<th>Kontakt</th>
</tr>
</thead>

<tbody id="data"></tbody>
</table>

<script>
// ===== DATA API =====
const DATA_API = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRc1EKWsR4iHnhk1PSgVAQ5u_YfM481jOzs9mxzXLvIZ0bhtz0TFRAAzw_15LJhvNSpyzb6dMA6IK0r/pub?output=csv";  

// ===== MAIL API =====
const MAIL_API = "https://script.google.com/macros/s/AKfycbyv-VrDI3swF6_a04Q8QiiRBpMWRRRGqxdSSTtYHcXMR5zEEtV39s3Z7rD-INh8A-kXew/exec";

fetch(DATA_API)
.then(r=>r.json())
.then(data=>{
  let html="";
  data.forEach((row,i)=>{
    html+=`
    <tr>
      <td>${cols[0]}</td>
      <td>${cols[4]}</td>
      <td>${cols[5]}</td>
      <td>${cols[6]}</td>
      <td>${cols[7]}</td>
      <td>${cols[8]}</td>
      <td>${cols[9]}</td>
      <td><button class="btn" onclick="unlock(${i})">Odemknout kontakt</button></td>
     </tr>`;
  });
  document.getElementById("data").innerHTML = html;
});

function unlock(id){
  const email = prompt("Zadej e-mail pro zasl√°n√≠ platebn√≠ch √∫daj≈Ø:");
  if(!email) return;

  fetch(MAIL_API,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({email:email,offer:id})
  });

  alert("Platebn√≠ √∫daje byly odesl√°ny na e-mail.");
}
</script>

</body>
</html>
