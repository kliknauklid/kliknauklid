<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Nab√≠dky √∫klidu | Klik na √∫klid</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f5f5f5;
    margin:0;
    padding:20px;
}

h1{
    text-align:center;
}

table{
    width:100%;
    border-collapse:collapse;
    background:white;
}

th, td{
    border:1px solid #ddd;
    padding:10px;
    text-align:left;
}

th{
    background:#7b2cbf;
    color:white;
}

tr:nth-child(even){
    background:#f2f2f2;
}

.lock{
    color:#999;
    font-style:italic;
}
</style>
</head>

<body>

<h1>Nab√≠dky √∫klidu</h1>
<p style="text-align:center;">Kontakty jsou dostupn√© pouze pro registrovan√© ubytovatele üîí</p>

<table id="data">
<thead>
<tr>
<th>Lokalita</th>
<th>Zku≈°enosti</th>
<th>Dostupnost</th>
<th>Typ √∫klidu</th>
<th>Frekvence</th>
<th>Vlastn√≠ vybaven√≠</th>
<th>Doprava</th>
<th>Pozn√°mka</th>
<th>Kontakt</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTppWCz9bX9UbhtaJjoJzCVBrZPwCDgfvVbpi71sGEWjZ-PC9isdwz3_HssADFrs1p5Z92FocfJOiBN/pubhtml";

fetch(sheetURL)
.then(res => res.text())
.then(html => {
    const parser = new DOMParser();
    const doc = parser.parseFromString(html, 'text/html');
    const rows = doc.querySelectorAll("table tr");

    const tbody = document.querySelector("#data tbody");

    rows.forEach((row, index) => {
        if(index === 0) return; // hlaviƒçka

        const cells = row.querySelectorAll("td");
        if(cells.length < 1) return;

        const tr = document.createElement("tr");

        // ‚ö†Ô∏è INDEXY SLOUPC≈Æ ‚Äì UPRAV√çME PODLE FORMUL√Å≈òE
        const lokalita = cells[3]?.innerText || "";
        const zkusenosti = cells[4]?.innerText || "";
        const dostupnost = cells[5]?.innerText || "";
        const typ = cells[6]?.innerText || "";
        const frekvence = cells[7]?.innerText || "";
        const vybaveni = cells[8]?.innerText || "";
        const doprava = cells[9]?.innerText || "";
        const poznamka = cells[10]?.innerText || "";

        tr.innerHTML = `
            <td>${lokalita}</td>
            <td>${zkusenosti}</td>
            <td>${dostupnost}</td>
            <td>${typ}</td>
            <td>${frekvence}</td>
            <td>${vybaveni}</td>
            <td>${doprava}</td>
            <td>${poznamka}</td>
            <td class="lock">üîí Kontakt po registraci</td>
        `;

        tbody.appendChild(tr);
    });
});
</script>

</body>
</html>
